# ğŸ“˜ SUB-BAB 13.3: KEAMANAN MODERN: JSON WEB TOKEN (JWT)

## ğŸ¯ Tujuan Pembelajaran
Setelah mempelajari sub-bab ini, kamu akan mampu:
1.  Menjelaskan struktur **JSON Web Token (JWT)** dan fungsinya sebagai "Paspor Digital".
2.  Membedakan antara otentikasi berbasis **Session** (Stateful) dan **Token** (Stateless).
3.  Mengidentifikasi keuntungan penggunaan JWT untuk skalabilitas server dan arsitektur Microservices.

---

## ğŸ”— Context & Hook
Bayangkan kamu masuk ke sebuah konser musik. Kamu melewati pemeriksaan tiket di gerbang utama. Setelah itu, kamu bebas keluar-masuk area panggung, toilet, dan stan makanan.

Apakah satpam di setiap pos (toilet, panggung, stan) meminta tiketmu dan menelepon panitia pusat untuk mengecek keasliannya *setiap kali* kamu lewat? Tidak. Itu akan sangat lama dan membuat antrian panjang.

Sebaliknya, saat di gerbang utama, kamu diberi **Gelang Kertas** atau **Cap Tangan**. Satpam di dalam hanya perlu melihat gelang itu. Jika gelangnya asli dan tidak rusak, kamu boleh lewat. Cepat, efisien, dan tidak butuh telepon ke pusat. Inilah cara kerja **JWT** dalam aplikasi modern.

---

## ğŸ’¡ Analogi: Buku Tamu vs. Paspor Cap
1.  **Session (Cara Lama):** Seperti **Buku Tamu**.
    Setiap kali kamu minta data, resepsionis (Server) harus membuka buku besar (Database/RAM) untuk mencari namamu. "Sebentar ya, saya cek apakah Budi sudah check-in...". Jika ada 1 juta tamu, resepsionis akan pusing dan lambat.
2.  **JWT (Cara Modern):** Seperti **Paspor dengan Cap Visa**.
    Saat login, Negara (Server) memberimu Paspor yang sudah dicap dan ditandatangani. Saat kamu mau masuk kota lain (API/Service lain), kamu cukup tunjukkan Paspor itu. Petugas imigrasi hanya perlu melihat **Tanda Tangan** (Signature) di paspor untuk memastikan itu asli. Mereka **tidak perlu** menelepon kantor pusat penerbit paspor.

---

## ğŸ“š Inti Materi

### 1. Apa itu JWT?
JWT (JSON Web Token) adalah standar terbuka untuk mentransfer data klaim (informasi identitas) antar pihak secara aman dan ringkas.
* **Sifat:** Ringan, mudah dikirim lewat URL atau Header HTTP.
* **Fungsi:** Menggantikan Session ID tradisional untuk menjaga status login pengguna.

### 2. Struktur JWT (3 Bagian)
JWT terdiri dari tiga bagian yang dipisahkan titik (`.`), contoh: `aaaaaa.bbbbbb.cccccc`.
1.  **Header:** Metadata tentang algoritma enkripsi (misal: HS256).
2.  **Payload:** Data yang dibawa (Klaim). Berisi User ID, Role ("admin"), dan waktu kedaluwarsa (*Expiration Time*). **Peringatan:** Bagian ini hanya di-*encode* (Base64), bukan dienkripsi. Siapapun bisa membacanya, jadi **jangan taruh password di sini!**
3.  **Signature (Tanda Tangan):** Bagian terpenting. Dibuat dengan rumus: `Hash(Header + Payload + Rahasia Server)`. Ini menjamin token tidak dipalsukan. Jika hacker mengubah Payload (misal: mengganti role "user" jadi "admin"), Signature akan berubah total dan server akan menolaknya.

### 3. Keunggulan: Stateless & Scalable
JWT bersifat **Stateless** (Tidak butuh ingatan).
Server tidak perlu menyimpan data "siapa yang sedang login" di memori (RAM) atau database. Server cukup memverifikasi tanda tangan JWT yang dikirim klien.
* **Manfaat:** Jika kamu punya 100 server (Microservices), user bisa mengirim request ke server mana saja tanpa masalah, karena server tidak perlu sinkronisasi data sesi.

---

## ğŸ“± Contoh Penerapan: Aplikasi Ojek Online
1.  **Login:** User memasukkan Username & Password.
2.  **Issue Token:** Server memverifikasi, lalu membuat JWT berisi `{id: 123, role: 'driver'}`. Server menandatanganinya dengan "Kunci Rahasia".
3.  **Simpan:** Aplikasi di HP menyimpan JWT ini di penyimpanan lokal.
4.  **Request:** Saat driver mengambil orderan, aplikasi mengirim request ke API dengan menyertakan JWT di *Header* (`Authorization: Bearer <token>`).
5.  **Verifikasi:** Server penerima order mengecek tanda tangan JWT. Valid? Oke, order diterima. Server tidak perlu mengecek database user untuk tahu siapa dia.

---

## ğŸ“– Mini-Glossary
* **Stateless:** Kondisi di mana server tidak menyimpan status sesi pengguna; setiap request harus membawa informasi lengkap (token) sendiri.
* **Payload:** Bagian dari JWT yang memuat data informasi pengguna (klaim).
* **Signature:** Tanda tangan kriptografis untuk memverifikasi integritas data token.
* **Base64Url:** Format pengkodean teks yang digunakan untuk Header dan Payload JWT.

---

## ğŸ“ Evaluasi Singkat

### 5 Soal Pilihan Ganda (HOTS)

1.  **Analisis:** Mengapa arsitek sistem sangat menyarankan penggunaan JWT untuk arsitektur *Microservices* dibandingkan *Session* biasa?
    * a. Karena JWT lebih sulit diretas.
    * b. Karena JWT bersifat *Stateless*; server mana pun bisa memverifikasi user tanpa harus bolak-balik mengecek database sesi terpusat, mengurangi latensi dan beban database.
    * c. Karena JWT bisa menyimpan gambar profil.
    * d. Karena Session tidak bisa berjalan di HP.
    * e. Karena Google yang menyuruh.

2.  **Keamanan:** Jika seorang hacker berhasil mencuri JWT milikmu (misalnya lewat serangan XSS), apa yang bisa dia lakukan?
    * a. Tidak ada, karena dia tidak tahu passwordmu.
    * b. Dia bisa login sebagai kamu dan mengakses akunmu sampai token tersebut kedaluwarsa (*expired*).
    * c. Dia bisa melihat password aslimu di dalam token.
    * d. Dia bisa mematikan server.
    * e. Dia bisa mengubah token menjadi admin.

3.  **Konsep:** Bagian manakah dari struktur JWT yang berfungsi untuk memastikan bahwa data di dalam token **TIDAK** pernah diubah/dimanipulasi oleh pihak ketiga sejak diterbitkan oleh server?
    * a. Header.
    * b. Payload.
    * c. Signature.
    * d. Base64.
    * e. HTTP.

4.  **Identifikasi:** Informasi apa yang **HARAM** (Sangat dilarang) untuk disimpan di dalam *Payload* JWT?
    * a. User ID (misal: 105).
    * b. Role (misal: 'admin').
    * c. Expiration Time (kapan token hangus).
    * d. Password pengguna atau PIN ATM.
    * e. Nama lengkap.

5.  **Skenario:** Server menerima request dengan JWT. Server menghitung ulang Hash dari Header+Payload dengan kunci rahasia server. Ternyata hasil Hash-nya **berbeda** dengan Signature yang tertera di token. Apa kesimpulan server?
    * a. Token valid.
    * b. Token kedaluwarsa.
    * c. Token palsu atau telah dimanipulasi (tampered); request harus ditolak.
    * d. Server sedang error.
    * e. User lupa password.

### Kunci Jawaban
1.  **b** (Statelessness adalah kunci skalabilitas horizontal di Microservices).
2.  **b** (Ini disebut *Token Theft*; token adalah kunci akses sementara).
3.  **c** (Signature akan rusak/tidak cocok jika 1 karakter pun di Payload diubah).
4.  **d** (Payload bisa dibaca siapa saja dengan mudah/Base64 decode, jadi jangan taruh rahasia di situ).
5.  **c** (Mekanisme integritas data: Hash yang tidak cocok berarti data sudah "disentuh" pihak tak berwenang).

---

## ğŸš€ Mini Challenge
**Dekoder JWT:**
1.  Buka situs **jwt.io** di browsermu.
2.  Lihat contoh token di halaman depan ("Encoded").
3.  Lihat bagian "Decoded" di sebelahnya. Kamu bisa membaca isi Payload-nya (nama: John Doe), kan?
4.  Coba ubah satu huruf saja di bagian Encoded. Perhatikan kotak biru di bawah ("Signature Verified") akan berubah jadi "Invalid Signature".
5.  Ini membuktikan: Siapapun bisa BACA token, tapi tidak ada yang bisa MENGUBAHNYA tanpa merusak tanda tangan.