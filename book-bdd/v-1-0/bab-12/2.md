# ğŸ“˜ SUB-BAB 12.2: MANAJEMEN AKSES: ROLE-BASED ACCESS CONTROL (RBAC)

## ğŸ¯ Tujuan Pembelajaran
Setelah mempelajari sub-bab ini, kamu akan mampu:
1.  Menjelaskan konsep **Role-Based Access Control (RBAC)** dan keunggulannya dibandingkan manajemen izin berbasis individu.
2.  Menerapkan prinsip **Least Privilege** (Hak Akses Minimal) untuk membatasi dampak jika terjadi peretasan.
3.  Membedakan penggunaan **Built-in Roles** dan **Custom Roles** dalam mengamankan arsitektur Microservices.

---

## ğŸ”— Context & Hook
Bayangkan sebuah perusahaan dengan 1.000 karyawan. Jika kamu adalah admin IT, dan ada karyawan baru masuk di divisi Keuangan, mana yang lebih efisien:
A.  Memilih satu per satu dari 500 folder yang boleh dia buka.
B.  Memberikan dia label "Staf Keuangan", dan otomatis dia bisa membuka semua folder yang relevan dengan keuangan.

Pilihan B adalah **RBAC**. Dalam dunia database, memberikan izin manual `read`, `write`, `update` ke setiap user untuk setiap koleksi adalah resep bencana. RBAC menyederhanakan ini dengan mengelompokkan izin ke dalam "Peran" (Role).

---

## ğŸ’¡ Analogi: Kartu Akses Hotel
* **User-Based Permission (Cara Lama):** Resepsionis harus memprogram kunci kamar kamu: "Buka Pintu 101, Buka Gym, Buka Kolam Renang". Jika aturan berubah (Gym ditutup), resepsionis harus memprogram ulang kunci semua tamu satu per satu.
* **RBAC (Cara Modern):** Resepsionis memberimu kartu tipe **"Tamu Standar"**. Sistem pusat mengatur bahwa "Tamu Standar" boleh masuk Kamar & Kolam Renang. Jika aturan berubah, admin cukup mengubah definisi "Tamu Standar" di komputer pusat, dan otomatis kartu semua orang terupdate.

---

## ğŸ“š Inti Materi

### 1. Apa itu RBAC?
**Role-Based Access Control (RBAC)** adalah metode membatasi akses sistem kepada pengguna yang berwenang berdasarkan peran mereka dalam organisasi.
* **Role (Peran):** Kumpulan izin (Privileges). Contoh: `readWrite`, `dbAdmin`, `reportViewer`.
* **User (Pengguna):** Diberikan satu atau lebih Role.
* **Keuntungan:** Efisiensi manajemen. Jika ada perubahan kebijakan, kamu hanya perlu mengedit Role, bukan mengedit ratusan User.

### 2. Prinsip Least Privilege (Hak Akses Minimal)
Ini adalah hukum emas keamanan: **"Berikan akses sesedikit mungkin yang dibutuhkan seseorang untuk melakukan pekerjaannya, tidak lebih."**
* Mengapa? Untuk mengurangi **Blast Radius** (Area Dampak).
* Jika *Inventory Service* diretas, dan service itu punya akses "Admin", hacker bisa menghapus seluruh database.
* Jika *Inventory Service* hanya punya akses "Read/Write Inventory", hacker hanya bisa mengacak-acak stok, tapi data User dan Keuangan tetap aman.

### 3. Built-in vs. Custom Roles
MongoDB menyediakan peran bawaan (*Built-in Roles*) seperti:
* `read`: Hanya boleh baca.
* `readWrite`: Boleh baca dan tulis.
* `dbAdmin`: Boleh kelola indeks dan skema.

Namun, untuk keamanan maksimal, disarankan membuat **Custom Roles**.
* *Contoh:* Role `inventoryManager` yang hanya boleh `readWrite` di koleksi `products`, tapi **tidak boleh** menyentuh koleksi `system` atau `users`.

---

## ğŸ“± Contoh Penerapan: Microservices
Dalam arsitektur *Database per Service* (Bab 10), setiap layanan adalah "User" yang unik.
1.  **User Service:** Diberi role `userAdmin` yang punya akses penuh ke database `db_users`.
2.  **Order Service:** Diberi role `orderProcessor`.
    * Izin: `readWrite` di `db_orders`.
    * Larangan: Tidak punya akses apa pun ke `db_users`.
3.  **Dampak:** Jika kode *Order Service* memiliki celah keamanan (bug), penyerang tidak bisa mencuri data profil pengguna karena secara *role* aksesnya diblokir.

---

## ğŸ“– Mini-Glossary
* **RBAC (Role-Based Access Control):** Mekanisme pembatasan akses berdasarkan peran pengguna.
* **Least Privilege:** Prinsip keamanan yang memberikan izin minimal yang diperlukan saja.
* **Privilege:** Hak spesifik untuk melakukan aksi tertentu (misal: `find`, `insert`, `createIndex`) pada resource tertentu.
* **Blast Radius:** Seberapa luas kerusakan yang bisa terjadi jika satu komponen keamanan ditembus.

---

## ğŸ“ Evaluasi Singkat

### 5 Soal Pilihan Ganda (HOTS)

1.  **Analisis:** Mengapa memberikan peran `root` atau `dbAdmin` kepada aplikasi Microservice dianggap praktik keamanan yang buruk?
    * a. Karena membuat aplikasi menjadi lambat.
    * b. Karena melanggar prinsip *Least Privilege*; jika layanan tersebut diretas, penyerang memiliki kendali penuh atas seluruh database cluster.
    * c. Karena peran tersebut hanya untuk manusia.
    * d. Karena MongoDB tidak mengizinkannya.
    * e. Karena boros memori.

2.  **Skenario:** Anda memiliki tim "Data Analyst" yang tugasnya hanya membuat laporan bulanan. Mereka tidak boleh mengubah data. Role apa yang paling tepat diberikan?
    * a. `readWrite`
    * b. `dbAdmin`
    * c. `read` (pada database yang relevan saja)
    * d. `root`
    * e. `restore`

3.  **Konsep:** Apa keuntungan utama menggunakan *Custom Roles* dibandingkan *Built-in Roles* dalam sistem yang kompleks?
    * a. Custom Roles lebih mudah dibuat.
    * b. Custom Roles memungkinkan definisi izin yang sangat spesifik (granular) sesuai kebutuhan bisnis, menghindari pemberian izin berlebihan yang sering ada di Built-in Roles.
    * c. Custom Roles tidak butuh password.
    * d. Custom Roles otomatis mengenkripsi data.
    * e. Built-in Roles sering error.

4.  **Arsitektur:** Bagaimana RBAC membantu mengamankan arsitektur *Polyglot Persistence* (banyak jenis database)?
    * a. Dengan menyatukan semua password.
    * b. RBAC tidak bisa digunakan di Polyglot.
    * c. Dengan memastikan setiap layanan hanya memiliki akses ke databasenya sendiri, mencegah akses silang yang tidak sah antar-layanan (Lateral Movement).
    * d. Dengan menghapus data duplikat.
    * e. Dengan membuat database menjadi satu.

5.  **Definisi:** Situasi di mana seorang user memiliki hak akses lebih banyak daripada yang dia butuhkan untuk pekerjaannya disebut...
    * a. Least Privilege.
    * b. Over-Provisioning / Privilege Creep.
    * c. Authentication Failure.
    * d. Encryption at Rest.
    * e. Sharding.

### Kunci Jawaban
1.  **b** (Risiko keamanan maksimal jika privilege tidak dibatasi).
2.  **c** (Analis hanya butuh membaca data, tidak menulis).
3.  **b** (Presisi izin adalah kunci keamanan *Enterprise*).
4.  **c** (Isolasi akses adalah pertahanan utama di sistem terdistribusi).
5.  **b** (Pelanggaran prinsip *Least Privilege*).

---

## ğŸš€ Mini Challenge
**Desain Role:**
Anda adalah Admin Database untuk aplikasi Toko Online. Buatlah rancangan *Custom Role* untuk **"Customer Support Staff"**.
* **Tugas mereka:** Melihat status pesanan, melihat profil user untuk verifikasi.
* **Larangan:** Tidak boleh mengubah harga barang, tidak boleh menghapus data user.
* **Tugasmu:** Tentukan akses `read` dan `write` untuk koleksi `orders` dan `users`.
    * *Jawaban:* Role `supportStaff`:
        * `db_orders`: Action [`find`] (Read Only)
        * `db_users`: Action [`find`] (Read Only)
        * `db_products`: Action [`find`] (Read Only)
        * Tidak ada akses `insert`, `update`, atau `delete`.

---
*Akses sudah diatur rapi. Tapi bagaimana jika ada orang dalam yang mencuri harddisk server? Ketik **"Lanjut"** untuk masuk ke **Sub-Bab 12.3: Benteng Terakhir: Enkripsi (At-Rest, In-Transit, & FLE)**.*