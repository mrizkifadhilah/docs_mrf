# ğŸ“˜ SUB-BAB 12.1: PILAR KEAMANAN: AUTENTIKASI VS. OTORISASI

## ğŸ¯ Tujuan Pembelajaran
Setelah mempelajari sub-bab ini, kamu akan mampu:
1.  Membedakan secara fundamental antara **Autentikasi (AuthN)** dan **Otorisasi (AuthZ)** dalam konteks keamanan basis data.
2.  Menjelaskan mengapa Autentikasi adalah garis pertahanan pertama yang menjawab pertanyaan "Siapa Kamu?".
3.  Menganalisis peran Otorisasi dalam menjawab pertanyaan "Apa yang Boleh Kamu Lakukan?" setelah identitas terverifikasi.

---

## ğŸ”— Context & Hook
Banyak developer pemula sering tertukar antara istilah "Login" dan "Izin Akses", padahal dalam arsitektur keamanan, keduanya adalah proses yang sangat berbeda.

Bayangkan kamu membangun sebuah gedung rahasia. Apakah cukup hanya dengan memeriksa KTP di gerbang depan? Tentu tidak. Setelah orang tersebut masuk, apakah dia boleh masuk ke Ruang Server? Atau Ruang Brankas? Atau hanya boleh di Lobi?

Keamanan basis data bekerja dengan cara yang sama. MongoDB tidak hanya perlu tahu siapa yang mencoba masuk (**Autentikasi**), tetapi juga harus membatasi apa yang boleh mereka sentuh (**Otorisasi**). Tanpa pemisahan ini, satu user yang berhasil login bisa menghapus seluruh data perusahaan.

---

## ğŸ’¡ Analogi: Paspor dan Visa
Untuk memahami perbedaannya dengan jelas, bayangkan proses imigrasi di bandara:

1.  **Autentikasi (Paspor):**
    Petugas memeriksa paspor Anda. Apakah fotonya cocok dengan wajah Anda? Apakah paspornya asli?
    * *Pertanyaan:* **"Apakah Anda benar-benar orang yang Anda klaim?"**
    * *Fungsi:* Verifikasi Identitas.
2.  **Otorisasi (Visa):**
    Setelah identitas Anda terbukti (Paspor valid), petugas memeriksa Visa di dalamnya. Apakah Visa ini untuk Turis (hanya boleh jalan-jalan) atau Kerja (boleh mencari uang)?
    * *Pertanyaan:* **"Apa hak akses yang Anda miliki di negara ini?"**
    * *Fungsi:* Verifikasi Wewenang/Izin.

---

## ğŸ“š Inti Materi

### 1. Autentikasi (Authentication - AuthN)
Autentikasi adalah proses verifikasi identitas pengguna atau layanan (service) yang mencoba terhubung ke database.
* **Mekanisme di MongoDB:** Metode paling umum adalah **SCRAM** (Challenge-Response Authentication Mechanism) yang menggunakan username dan password yang di-hash. Untuk level enterprise, bisa menggunakan **LDAP** atau **Kerberos**.
* **Penerapan:** Setiap kali aplikasi atau developer membuka koneksi ke MongoDB, mereka harus menyerahkan *credentials*. Jika gagal, koneksi ditolak total.

### 2. Otorisasi (Authorization - AuthZ)
Otorisasi adalah proses penentuan hak akses (privileges) yang dimiliki oleh identitas yang sudah terautentikasi. Otorisasi **selalu** terjadi setelah Autentikasi sukses.
* **Mekanisme di MongoDB:** Menggunakan **Role-Based Access Control (RBAC)**.
* **Penerapan:** Setelah login sukses, MongoDB memeriksa peran user tersebut.
    * Apakah user ini boleh melakukan `insert` ke koleksi `orders`?
    * Apakah user ini boleh melakukan `dropDatabase`?
    * Jika user mencoba operasi di luar izinnya, MongoDB akan melempar error "Unauthorized".

### 3. Hubungan dalam Microservices
Dalam arsitektur Microservices (Bab 10), "User" yang login ke database seringkali bukan manusia, melainkan **Service**.
* *Inventory Service* melakukan Autentikasi ke database inventaris menggunakan kredensial khusus servis.
* Otorisasi membatasi *Inventory Service* agar hanya bisa baca-tulis di koleksi stok, tapi tidak bisa menyentuh koleksi user lain (jika ada).

---

## ğŸ“± Contoh Penerapan: Aplikasi Rumah Sakit
1.  **Skenario:** Dokter Budi ingin melihat rekam medis pasien.
2.  **Langkah 1 (Autentikasi):** Dokter Budi memasukkan username dan password. Sistem memverifikasi bahwa ini benar-benar Dokter Budi. (Sukses).
3.  **Langkah 2 (Otorisasi):** Dokter Budi mencoba membuka data Gaji Karyawan.
    * Sistem mengecek Role Dokter Budi: "Medical Staff".
    * Izin Role: Boleh baca rekam medis, **Dilarang** baca data gaji.
    * Hasil: Akses Ditolak (*Access Denied*), meskipun Budi sudah login.

---

## ğŸ“– Mini-Glossary
* **Autentikasi (AuthN):** Proses memvalidasi identitas entitas (siapa dia).
* **Otorisasi (AuthZ):** Proses memvalidasi hak akses entitas terhadap sumber daya (apa yang boleh dia lakukan).
* **SCRAM:** Mekanisme autentikasi default MongoDB yang aman berbasis password hashing.
* **Principal:** Entitas (user atau aplikasi) yang telah berhasil diautentikasi.

---

## ğŸ“ Evaluasi Singkat

### 5 Soal Pilihan Ganda (HOTS)

1.  **Analisis:** Jika seorang hacker berhasil mencuri password database admin, pilar keamanan manakah yang telah dia tembus?
    * a. Otorisasi.
    * b. Enkripsi.
    * c. Autentikasi (karena dia berhasil membuktikan dirinya sebagai admin yang sah menggunakan kredensial curian).
    * d. Auditing.
    * e. Availability.

2.  **Skenario:** Sebuah aplikasi berhasil terhubung ke MongoDB, tetapi saat mencoba menjalankan perintah `db.collection.drop()`, database mengembalikan error "not authorized to execute command". Apa artinya ini?
    * a. Autentikasi gagal (password salah).
    * b. Autentikasi sukses (identitas dikenali), tetapi Otorisasi gagal (akun tersebut tidak punya hak akses untuk menghapus koleksi).
    * c. Database sedang down.
    * d. Koneksi jaringan putus.
    * e. Disk penuh.

3.  **Konsep:** Mengapa Otorisasi tidak mungkin dilakukan sebelum Autentikasi?
    * a. Karena Otorisasi lebih berat.
    * b. Karena sistem harus tahu "Siapa Kamu" (Autentikasi) terlebih dahulu sebelum bisa memutuskan "Apa Hak Kamu" (Otorisasi).
    * c. Karena MongoDB tidak mendukungnya.
    * d. Karena Autentikasi adalah fitur opsional.
    * e. Karena Otorisasi membutuhkan enkripsi.

4.  **Identifikasi:** Manakah di bawah ini yang merupakan contoh mekanisme **Autentikasi**?
    * a. Memberikan izin `readWrite` pada koleksi `sales`.
    * b. Memverifikasi sidik jari atau password user.
    * c. Mencegah user mengakses data gaji.
    * d. Membatasi akses hanya dari IP address tertentu.
    * e. Mengenkripsi data di disk.

5.  **Arsitektur:** Dalam pola *Database per Service*, mengapa kita perlu membuat akun database (user DB) yang berbeda untuk setiap Microservice?
    * a. Agar database terlihat ramai.
    * b. Untuk menerapkan Autentikasi dan Otorisasi yang terisolasi; jika kredensial satu service bocor, penyerang tidak otomatis memiliki akses ke data milik service lain.
    * c. Agar hemat memori.
    * d. Karena MongoDB membatasi jumlah koneksi per user.
    * e. Agar log lebih berwarna.

### Kunci Jawaban
1.  **c** (Pencurian kredensial memanipulasi verifikasi identitas).
2.  **b** (Sistem mengenali user, tapi membatasi tindakannya).
3.  **b** (Identitas adalah prasyarat mutlak untuk pengecekan izin).
4.  **b** (Verifikasi identitas subjek).
5.  **b** (Prinsip *Defense in Depth* dan *Blast Radius Reduction*).

---

## ğŸš€ Mini Challenge
**Roleplay Satpam:**
Bayangkan kamu adalah database.
1.  Ada request masuk: "User: tamu, Pass: 1234, Action: Hapus Data".
2.  Kamu cek daftar user. "tamu" ada, password benar. (**Autentikasi Lolos**).
3.  Kamu cek daftar izin. "tamu" hanya punya role "Read-Only".
4.  Apa keputusanmu terhadap Action "Hapus Data"? (**Otorisasi Ditolak**).
5.  Tulis pesan error yang tepat: *"User 'tamu' is not authorized to perform 'drop' on this collection."*

---
*Identitas sudah jelas, tapi bagaimana cara mengatur izin untuk ribuan user tanpa pusing? Ketik **"Lanjut"** untuk masuk ke **Sub-Bab 12.2: Manajemen Akses: Role-Based Access Control (RBAC)**.*