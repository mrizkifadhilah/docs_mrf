# ğŸ“˜ SUB-BAB 12.3: BENTENG TERAKHIR: ENKRIPSI (AT-REST, IN-TRANSIT, & FLE)

## ğŸ¯ Tujuan Pembelajaran
Setelah mempelajari sub-bab ini, kamu akan mampu:
1.  Membedakan **Enkripsi In-Transit** (melindungi jalur komunikasi) dan **Enkripsi At-Rest** (melindungi penyimpanan fisik).
2.  Menjelaskan konsep **Field-Level Encryption (FLE)** atau *Client-Side Encryption* sebagai perlindungan data paling mutakhir.
3.  Menganalisis trade-off antara keamanan maksimal FLE dengan keterbatasan fitur kueri (Indeks) pada data terenkripsi.

---

## ğŸ”— Context & Hook
Bayangkan skenario buruk ini:
1.  Hacker menyadap Wi-Fi kafe saat admin database sedang bekerja.
2.  Maling masuk ke Data Center dan mencuri harddisk fisik server.
3.  Seorang Admin Database (DBA) yang korup mencoba mengintip nomor kartu kredit pengguna.

Autentikasi dan Otorisasi (Bab 12.1 & 12.2) tidak berguna di sini karena hacker tidak mencoba "Login", melainkan mencuri data fisik atau menyadap jalur kabel.

Di sinilah **Enkripsi** berperan sebagai benteng terakhir. Enkripsi mengubah data `Budi` menjadi acak `x7#b9@z` yang tidak bisa dibaca tanpa kunci. Di sub-bab ini, kita akan mempelajari cara melindungi data di tiga lokasi: saat bergerak, saat diam, dan saat sedang diproses.

---

## ğŸ’¡ Analogi: Mengirim Surat Rahasia
Bayangkan kamu mengirim dokumen rahasia negara:
1.  **Enkripsi In-Transit (Truk Baja):** Surat dimasukkan ke dalam truk lapis baja saat dikirim di jalan raya. Orang di jalan tidak bisa melihat isinya. Tapi begitu sampai di gudang dan dikeluarkan, surat itu telanjang.
2.  **Enkripsi At-Rest (Brankas Gudang):** Sesampainya di gudang, surat disimpan di dalam brankas besi. Jika maling membobol tembok gudang, mereka tidak bisa membuka brankas. Tapi, pemegang kunci gudang (Admin) bisa membukanya.
3.  **Field-Level Encryption / FLE (Sandi Rahasia):** Sebelum surat dikirim, kamu menulisnya dalam kode rahasia (Sandi Morse acak). Surat itu dimasukkan ke truk (In-Transit), lalu disimpan di brankas (At-Rest).
    * Kehebatan FLE: Bahkan jika Admin Gudang membuka brankas, dia hanya melihat kode acak. Hanya penerima asli yang punya buku sandi untuk membacanya.

---

## ğŸ“š Inti Materi

### 1. Enkripsi In-Transit (Data Bergerak)
Melindungi data saat berpindah melalui jaringan (misal: dari Aplikasi ke MongoDB, atau antar-node Replica Set).
* **Ancaman:** *Man-in-the-Middle Attack* (Penyadapan/Sniffing).
* **Solusi:** Menggunakan protokol **TLS/SSL**.
* **Penerapan:** Wajibkan semua koneksi database menggunakan TLS. Tanpa sertifikat TLS yang valid, koneksi ditolak. Ini memastikan data `password` tidak lewat di kabel jaringan dalam bentuk teks polos.

### 2. Enkripsi At-Rest (Data Diam)
Melindungi data saat disimpan secara fisik di media penyimpanan (Harddisk/SSD).
* **Ancaman:** Pencurian fisik server, pencurian harddisk, atau akses file mentah oleh admin OS.
* **Solusi:** Fitur enkripsi bawaan *Storage Engine* (WiredTiger).
* **Penerapan:** WiredTiger mengenkripsi file database dan log. Kunci enkripsi disimpan di *Key Management System* (KMS) terpisah. Jika disk dicuri dan dipasang di komputer lain, isinya hanya sampah biner tak terbaca.

### 3. Field-Level Encryption / FLE (Client-Side)
Ini adalah fitur keamanan tingkat tinggi di mana enkripsi dilakukan **di sisi Aplikasi (Client)**, bukan di sisi Database.
* **Cara Kerja:**
    1.  Aplikasi mau simpan NIK: `12345`.
    2.  Driver MongoDB di aplikasi mengenkripsi NIK jadi `xkji89`.
    3.  Aplikasi kirim `xkji89` ke server MongoDB.
    4.  MongoDB menyimpan `xkji89` apa adanya (Server tidak punya kunci dekripsi).
* **Keunggulan:** **Separation of Duties**. Admin Database bisa mengelola server, backup, dan scaling, tapi dia **tidak bisa melihat data sensitif** (Blind Administrator).
* **Trade-off:** Data yang dienkripsi FLE sangat sulit di-query. Kamu tidak bisa melakukan `find({ nik: { $gt: 1000 } })` (lebih besar dari), karena database tidak tahu nilai aslinya. Kamu hanya bisa melakukan pencarian `Exact Match`.

---

## ğŸ“± Contoh Penerapan: Aplikasi Fintech
1.  **Data Umum (Nama, Alamat):** Hanya dilindungi TLS (In-Transit) dan Disk Encryption (At-Rest). Bisa di-query bebas, bisa di-index, bisa di-search teks.
2.  **Data Sensitif (Nomor Kartu Kredit, CVV):** Dilindungi dengan **FLE**.
    * Aplikasi mengenkripsi CVV sebelum dikirim.
    * Di database tersimpan sebagai biner acak.
    * Jika database di-hack, hacker dapat jutaan data sampah yang tidak bisa didekripsi tanpa kunci master yang dipegang aplikasi.

---

## ğŸ“– Mini-Glossary
* **Enkripsi In-Transit:** Perlindungan data saat melewati jaringan (menggunakan TLS/SSL).
* **Enkripsi At-Rest:** Perlindungan data saat disimpan di disk fisik.
* **Field-Level Encryption (FLE):** Enkripsi granular pada level kolom/field tertentu yang dilakukan di sisi klien sebelum data dikirim ke database.
* **Man-in-the-Middle (MITM):** Serangan di mana pelaku diam-diam mencegat dan mungkin mengubah komunikasi antara dua pihak.
* **KMS (Key Management System):** Sistem terpusat untuk mengelola kunci enkripsi secara aman.

---

## ğŸ“ Evaluasi Singkat

### 5 Soal Pilihan Ganda (HOTS)

1.  **Analisis:** Mengapa Enkripsi At-Rest (Disk Encryption) saja tidak cukup untuk melindungi data dari serangan "Admin Nakal" (DBA yang menyalahgunakan akses login-nya)?
    * a. Karena enkripsi disk mahal.
    * b. Karena Enkripsi At-Rest bersifat transparan bagi database engine; begitu service database menyala dan me-mount disk, data didekripsi otomatis di memori agar bisa dibaca/ditulis oleh user yang login (termasuk Admin).
    * c. Karena enkripsi disk memperlambat komputer.
    * d. Karena enkripsi disk hanya bekerja di Linux.
    * e. Karena Admin punya kunci disk.

2.  **Skenario:** Kamu menggunakan *Client-Side Field Level Encryption* (FLE) untuk kolom "Gaji". Apa konsekuensi teknisnya saat kamu ingin membuat fitur "Tampilkan Karyawan dengan Gaji > 10 Juta"?
    * a. Fitur berjalan normal.
    * b. Fitur akan sangat cepat.
    * c. Fitur **tidak bisa** dijalankan langsung di database (query range/sorting tidak jalan) karena database hanya melihat string acak terenkripsi, bukan angka.
    * d. Database akan error.
    * e. Gaji akan terhapus.

3.  **Identifikasi:** Protokol apa yang wajib diaktifkan untuk mencegah hacker membaca password user yang sedang dikirim dari Aplikasi Mobile ke Server Backend melalui Wi-Fi publik?
    * a. SSH.
    * b. FTP.
    * c. TLS/SSL (Enkripsi In-Transit).
    * d. WiredTiger Encryption.
    * e. MD5.

4.  **Konsep:** Apa keuntungan utama menggunakan FLE dalam konteks regulasi perlindungan data seperti **GDPR** atau **PCI-DSS**?
    * a. Hemat biaya storage.
    * b. Jika terjadi *Data Breach* (server dicuri), data sensitif dianggap tetap aman ("unintelligible") sehingga risiko hukum dan denda bisa diminimalkan.
    * c. Membuat aplikasi lebih cepat.
    * d. Menghapus data otomatis.
    * e. Tidak perlu backup.

5.  **Arsitektur:** Dalam sistem keamanan berlapis, jika Enkripsi At-Rest adalah "Brankas", maka Enkripsi In-Transit adalah...
    * a. Kunci brankas.
    * b. Mobil lapis baja yang mengangkut uang dari nasabah ke bank.
    * c. Satpam di pintu.
    * d. Kamera CCTV.
    * e. Buku tabungan.

### Kunci Jawaban
1.  **b** (Enkripsi disk melindungi dari pencurian fisik, bukan dari akses logis via aplikasi database).
2.  **c** (Trade-off keamanan vs fungsionalitas: data terenkripsi kehilangan sifat matematisnya di mata DB).
3.  **c** (Standar industri untuk keamanan jalur komunikasi).
4.  **b** (Data terenkripsi tanpa kunci dianggap tidak bocor secara efektif).
5.  **b** (Proteksi jalur distribusi).

---

## ğŸš€ Mini Challenge
**Simulasi FLE:**
Ambil secarik kertas.
1.  Tulis data asli: `{ nama: "Budi", saldo: 1000000 }`.
2.  Anggap kamu aplikasi dengan FLE. Enkripsi saldo (ubah jadi acak): `{ nama: "Budi", saldo: "x8&mn#1" }`.
3.  Sekarang, berperanlah sebagai Database Server.
4.  User minta: "Cari user dengan saldo > 500.000".
5.  Bisakah kamu (Database) menjawabnya dengan melihat data "x8&mn#1"? (Tidak bisa. Itulah harga yang dibayar untuk keamanan FLE).

---
*Bab 12 Selesai! Data aman, sistem terhubung. Ketik **"Lanjut"** untuk masuk ke **Bagian Penutup (Outro)**.*